# ПО восстановления пароля для протокола IKEv1 Main Mode

> Данное ПО представлено в двух модулях: первый модуль генерирует тесты, второй модуль подбирает пароль.

## Оптимизация

Была реализована оптимизация использования алгоритма SHA1 в HMAC. Оптимизация заключается в предварительном вычислении 
хеша от константных значений (`key + ipad`, `key + opad`), что снижает общее количество операций.

### Сравнение оптимизированного алгоритма с неоптимизированным

| Маска |  Без оптимизации   |   С оптимизацией   |
|:-----:|:------------------:|:------------------:|
|       | Скорость, канд./с. | Скорость, канд./с. |
|   a   |      546.9076      |      582.1167      |
|  ad   |      834.0943      |      868.516       |
|  aa   |     1328.6053      |     1335.01832     |
|  add  |      975.2022      |      997.5426      |

## 1. Генератор тестов для протокола IKEv1 Main Mode

ПО принимает на вход название хеш-функции, название алгоритма шифрования
 и пароль, а на выход файл с названием *Password_HashFunctionName_CipherName.txt*. В выходном файле - строка следующего 
формата:`HASH_id*ALG_id*Ni*Nr*g_x*g_y*g_xy*Ci*Cr*SAi*E_k`

### Входные параметры:
    
1. `-H HashFunctionName` - название хеш-функции, где `HashFunctionName` может быть либо `md5`, либо `sha1`.
2. `-a AlgorythmName` - название алгоритма шифрования, `AlgorythmName` может быть одним из следующих вариантов:
   1. `3des`
   2. `aes128`
   3. `aes192`
   4. `aes256`
3. `-p Password` - пароль, строка

### Примеры запуска

`python gen.py -H sha1 -a 3des -p 1aer23gd`

`python gen.py -H md5 -a aes192 -p 1111`

## 2. Подбор пароля для протокола IKEv1 Main Mode

ПО принимает на вход словарь и маску для подбора пароля, а также файл, в котором находятся данные для нахождения
открытого текста. В конце работы ПО выводится сообщение о нахождении пароля или о том, что поиск не удался.

### Входные параметры

1) `-d Dictionary.txt` - словарь для подбора пароля, содержит слова, разделённые символом перевода строки.
2) `-m MASK` - маска для подбора пароля, может состоять из следующих символов: `a` - любые латинские буквы и арабские 
цифры, `s` - только маленькие латинские буквы, `l` - только большие латинские буквы, `d` - только арабские цифры. 
Количество символов в маске соответствует длине генерируемого пароля.
3) `file` - файл, в котором находится строка в выше приведённом формате.

### Примеры запуска

`python crack.py -d dict.txt -m aassldld test.txt`

`python crack.py -d dict.txt -m lllll test.txt`

`python crack.py -d dict.txt -m lllasd test.txt`
